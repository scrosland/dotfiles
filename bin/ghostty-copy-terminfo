#!/usr/bin/env bash
set -euo pipefail

# This should work for any terminal, not just ghostty

if (($# < 1)); then
    echo "error: no host specified" >&2
    echo "usage: $(basename $0) host ..."
    exit 1
fi

for remote in "$@"; do
    echo "Copying terminfo to ${remote}"
    # Copy for the current user
    infocmp -x | ssh "${remote}" -- tic -x -
    # Try to copy for root, but allow it to fail
    infocmp -x | ssh "${remote}" -- sudo -n tic -x - || true
done

exit 0
