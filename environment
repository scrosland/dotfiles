#
# vim: set filetype=sh:
#
# Environment
#

if uname -a | grep -q -s Microsoft ; then
    WSL=$(uname -r) ; export WSL
fi

BROWSER='google-chrome' ; export BROWSER
EDITOR='vim' ; export EDITOR
LESS='-Xm' ; export LESS
SCM_EDITOR='viterm' ; export SCM_EDITOR

add_to_path_var()
{
    local var="$1"
    local dir="$2"
    if [ ! -d "${dir}" ] ; then
        return 1
    fi
    eval local current=\$${var}
    eval $( ruby -e '
        var = ARGV.shift()
        current = ARGV.shift()
        value = ARGV.shift()
        parts = current.split(":")
        unless parts.include?(value)
            parts.insert(0, value)
        end
        puts("#{var}=\"#{parts.join(":").inspect()}\"")
        ' "${var}" "${current}" "${dir}"
        )
    return 0
}

add_to_path_var_and_export()
{
    local var="$1"
    if add_to_path_var "$@" ; then
        export "${var}"
    fi
}

if [ -z "${CDPATH}" ] ; then
    add_to_path_var CDPATH "/Users/Shared"
    add_to_path_var CDPATH "${HOME}"
    add_to_path_var CDPATH "${HOME}/repos"
fi

add_to_path_var MANPATH "$HOME/.local/share/man"

add_to_path_var PATH "/Applications/Visual Studio Code.app/Contents/Resources/app/bin"
add_to_path_var PATH "/Applications/SCM.app/Contents/Resources/scm/bin"
add_to_path_var PATH "/Users/Shared/tools/scripts"
add_to_path_var PATH "${HOME}/bin"

add_to_path_var_and_export PYTHONPATH /Users/Shared/tools/libs/python
add_to_path_var_and_export RUBYLIB /Users/Shared/tools/libs/ruby
